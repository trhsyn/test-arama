<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Arapça-Türkçe Sözlük</title>
<style>
body { font-family: system-ui; padding:20px; background:#f9f9f9; }
h2 { margin-top:30px; }
input, textarea, select, button { width:100%; padding:8px; margin:5px 0 15px 0; font-size:16px; box-sizing:border-box; }
button { cursor:pointer; background:#2563eb; color:white; border:none; border-radius:5px; font-size:16px; }
button:hover { background:#1d4ed8; }
.card { margin-top:15px; padding:10px; border:1px solid #ccc; border-radius:8px; background:white; }
.card-title { font-weight:bold; font-size:18px; margin-bottom:5px; }
.tag { background:#f59e0b; color:white; padding:2px 6px; border-radius:4px; font-size:12px; margin-left:5px; }
.ar { font-size:22px; direction:rtl; font-family: "Scheherazade", "Amiri", serif; }
.ex strong.hl { background:#ffeb3b; color:#000; padding:0 2px; }
</style>
</head>
<body>

<h2>Kelime Ekle</h2>
<form id="entryForm">
  <label>Kelime Türü</label>
  <select id="type">
    <option value="isim">İsim</option>
    <option value="fiil">Fiil</option>
    <option value="mastar">Mastar</option>
    <option value="deyim">Deyim</option>
  </select>

  <label>Arapça Kelime</label>
  <input id="word" required>

  <label>Türkçe Karşılık</label>
  <input id="tr" required>

  <label>Arapça Örnek Cümle</label>
  <textarea id="exAr"></textarea>

  <label>Türkçe Çeviri</label>
  <textarea id="exTr"></textarea>

  <label>Not</label>
  <textarea id="note"></textarea>

  <button type="submit">➕ Ekle</button>
</form>

<h2>Kelime Arama</h2>
<input id="search" placeholder="Arapça veya Türkçe arayın">

<div id="list"></div>

<script>
// ARAPÇA NORMALİZASYON
function normalizeArabic(text) {
  if(!text) return "";
  return text
    .replace(/[\u064B-\u065F\u0670]/g,"") // Tüm harekeler
    .replace(/\u0640/g,"")                 // Tatweel
    .replace(/[آأإٱ]/g,"ا")                // Elif çeşitleri
    .replace(/[يى]/g,"ي")                  // Ya
    .replace(/ة/g,"ه")                     // Te marbuta
    .replace(/ؤ/g,"و")                     // Hemzeli Vav
    .replace(/ئ/g,"ي")                     // Hemzeli Ya
    .trim();
}

// RENDER FONKSİYONU
function render() {
  const list = document.getElementById("list");
  const query = document.getElementById("search").value.trim().toLowerCase();
  const data = JSON.parse(localStorage.getItem("dict") || "[]");

  list.innerHTML = "";

  data
    .filter(e => {
      const ar = normalizeArabic(e.word + " " + (e.exAr || ""));
      const tr = (e.tr || "").toLowerCase();
      return ar.includes(normalizeArabic(query)) || tr.includes(query);
    })
    .forEach(e => {
      let ex = (e.exAr || "").replace(
        new RegExp(e.word,"g"),
        `<strong class="hl">${e.word}</strong>`
      );
      list.innerHTML += `
        <div class="card">
          <div class="card-title">
            ${e.word} <span class="tag">${e.type}</span>
          </div>
          <div><b>Türkçe:</b> ${e.tr}</div>
          ${e.exAr ? `<div class="ar ex">${ex}</div>` : ""}
          ${e.exTr ? `<div>${e.exTr}</div>` : ""}
          ${e.note ? `<div><i>Not:</i> ${e.note}</div>` : ""}
        </div>
      `;
    });
}

// ARAMA KUTUSU EVENT
document.getElementById("search").addEventListener("input", render);

// EKLEME FORMU
document.getElementById("entryForm").addEventListener("submit", function(e){
  e.preventDefault();
  const word = document.getElementById("word").value.trim();
  const tr = document.getElementById("tr").value.trim();
  if(!word || !tr) { alert("Arapça kelime ve Türkçe karşılık zorunlu"); return; }

  const entry = {
    id: Date.now(),
    type: document.getElementById("type").value,
    word,
    tr,
    exAr: document.getElementById("exAr").value.trim(),
    exTr: document.getElementById("exTr").value.trim(),
    note: document.getElementById("note").value.trim()
  };

  const data = JSON.parse(localStorage.getItem("dict") || "[]");
  data.unshift(entry); // en başa ekle
  localStorage.setItem("dict", JSON.stringify(data));

  this.reset();
  render();
});

// SAYFA AÇILIRKEN RENDER ET
render();
</script>

</body>
</html>
